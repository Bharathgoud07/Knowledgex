{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="container mt-4">
  <h3 class="mb-3">Subject-wise Resource Dashboard</h3>
  <p class="text-muted">
    Overview of uploads, downloads, and views per subject.
  </p>

  <div class="card shadow p-4">
    <canvas id="subjectChart" height="120"></canvas>
  </div>
</div>

<!-- Chart.js CDN -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
  const labels = {{ labels|safe }};
  const uploads = {{ uploads|safe }};
  const downloads = {{ downloads|safe }};
  const views = {{ views|safe }};

  const ctx = document.getElementById('subjectChart').getContext('2d');

  new Chart(ctx, {
    type: 'bar',
    data: {
      labels: labels,
      datasets: [
        {
          label: 'Uploads',
          data: uploads,
          borderWidth: 1
        },
        {
          label: 'Downloads',
          data: downloads,
          borderWidth: 1
        },
        {
          label: 'Views',
          data: views,
          borderWidth: 1
        }
      ]
    },
    options: {
      responsive: true,
      scales: {
        y: {
          beginAtZero: true,
          ticks: { precision: 0 }
        }
      }
    }
  });
</script>
{% endblock %}
